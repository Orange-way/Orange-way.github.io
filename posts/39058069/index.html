<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="喜欢晴天，喜欢雨天">
    
      <link rel="icon" href="/img/favicon.ico">
    
    <meta name="keyword"  content="">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>

  <div class="page">
    <div class="head">
      <header class="head-header">
  <h1 class="head-authorH">
    <a href="/" class="head-authorLink">
      橙子</a>
  </h1>
  <div class="head-right">
    <!-- <div class="head-search">
      <input class="head-searchK"></input>
      <span class="head-searchT">
        </span>
    </div> -->
    <button class="barWrap" id="barWrap-toggle">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </button>
    <div class="head-about" id="head-about">
      
      <a class="head-aboutLink" href="/about">
        About</a>
      
    </div>
  </div>
</header>
    </div>
    <div class="main">
        <div class="barShow-head" id="barShow">
  <ul class="barShow-ul">
    
      <li class="barShow-item">
        <a href="/archives"><span>
            Archives</span></a>
      </li>
    
      <li class="barShow-item">
        <a href="/categories/life"><span>
            Lifes</span></a>
      </li>
    
      <li class="barShow-item">
        <a href="/tags"><span>
            Tags</span></a>
      </li>
    
    
      <li class="barShow-item">
        <a class="head-aboutLink" href="/about">
          About
        </a>
      </li>
    
  </ul>
</div>
      <article class="post" id="post">
  <header class="post-head">
    <h1 class="post-title">
      <a class="title" href="/posts/39058069/">
        redux 总结
      </a>
    </h1>
  </header>
  <div class="post-datetag">
    <div class="post-date">
      <time class="post-time" title="2019-03-19 17:32:34" datetime="2019-03-19T09:32:34.000Z" itemprop="datePublished">
  2019-03-19</time>
    </div>
    <div class="post-tag">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/">react</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redux/">redux</a></li></ul>

    </div>
  </div>
  <div class="article-entry" itemprop="articleBody">
    
    <p>redux &#x662F;&#x72EC;&#x7ACB;&#x7684;&#xFF0C;react&#x53EF;&#x4EE5;&#x5F15;&#x5165;&#x5B83;&#x6765;&#x89E3;&#x51B3;&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x548C; vuex &#x5728; vue &#x4E2D;&#x8D77;&#x7684;&#x4F5C;&#x7528;&#x4E00;&#x6837; <a id="more"></a></p>
<p>redux &#x7684;&#x5177;&#x4F53;&#x8FC7;&#x7A0B;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF0C;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;</p>
<p><img src="/posts/39058069/one.jpg" alt=""></p>
<p>&#x6B65;&#x9AA4;&#xFF1A;</p>
<h4 id="&#x5B89;&#x88C5;redux&#xFF1A;"><a href="#&#x5B89;&#x88C5;redux&#xFF1A;" class="headerlink" title="&#x5B89;&#x88C5;redux&#xFF1A;"></a>&#x5B89;&#x88C5;redux&#xFF1A;</h4><p>npm install redux &#x2013;save</p>
<p>&#x200B;                        </p>
<h4 id="&#x8FD9;&#x6B21;&#x4F9D;&#x7136;&#x7528;-Todolist-&#x4E3E;&#x4F8B;"><a href="#&#x8FD9;&#x6B21;&#x4F9D;&#x7136;&#x7528;-Todolist-&#x4E3E;&#x4F8B;" class="headerlink" title="&#x8FD9;&#x6B21;&#x4F9D;&#x7136;&#x7528; Todolist &#x4E3E;&#x4F8B;"></a>&#x8FD9;&#x6B21;&#x4F9D;&#x7136;&#x7528; Todolist &#x4E3E;&#x4F8B;</h4><p>&#x9875;&#x9762;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="/posts/39058069/two.png" alt=""></p>
<h4 id="&#x65B0;&#x5EFA;-store-&#x6587;&#x4EF6;&#x5939;"><a href="#&#x65B0;&#x5EFA;-store-&#x6587;&#x4EF6;&#x5939;" class="headerlink" title="&#x65B0;&#x5EFA; store &#x6587;&#x4EF6;&#x5939;"></a>&#x65B0;&#x5EFA; store &#x6587;&#x4EF6;&#x5939;</h4><p>&#x5904;&#x7406;&#x72B6;&#x6001;&#x7684;&#x4E1C;&#x897F;&#x653E;&#x5230;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#xFF0C;&#x76EE;&#x5F55;&#x5982;&#x4E0B;:</p>
<p><img src="/posts/39058069/three.png" alt=""></p>
<h4 id="getState-&#x83B7;&#x53D6;-store-&#x4E2D;&#x7684;&#x503C;"><a href="#getState-&#x83B7;&#x53D6;-store-&#x4E2D;&#x7684;&#x503C;" class="headerlink" title="getState &#x83B7;&#x53D6; store &#x4E2D;&#x7684;&#x503C;"></a>getState &#x83B7;&#x53D6; store &#x4E2D;&#x7684;&#x503C;</h4><p>todoList.js:</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, { Component } <span class="keyword">from</span> <span class="string">&apos;react&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&apos;../store&apos;</span>;   <span class="comment">//&#x5F15;&#x5165; store</span></span><br><span class="line"></span><br><span class="line">state = store.getState()</span><br></pre></td></tr></tbody></table></figure>
<p>&#x200B;                            </p>
<h4 id="&#x901A;&#x8FC7;-dispatch-&#x6539;&#x53D8;-store-&#x4E2D;&#x7684;&#x503C;"><a href="#&#x901A;&#x8FC7;-dispatch-&#x6539;&#x53D8;-store-&#x4E2D;&#x7684;&#x503C;" class="headerlink" title="&#x901A;&#x8FC7; dispatch &#x6539;&#x53D8; store &#x4E2D;&#x7684;&#x503C;"></a>&#x901A;&#x8FC7; dispatch &#x6539;&#x53D8; store &#x4E2D;&#x7684;&#x503C;</h4><p>todoList.js:</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, { Component } <span class="keyword">from</span> <span class="string">&apos;react&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&apos;../store&apos;</span>;   <span class="comment">//&#x5F15;&#x5165; store</span></span><br><span class="line"></span><br><span class="line">&lt;input value={ <span class="keyword">this</span>.state.inpVal } onChange={ <span class="keyword">this</span>.handleChange }&gt;<span class="xml"><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x4E2D; &#x901A;&#x8FC7; dispatch &#x53BB;&#x6539;&#x53D8; store &#x7684;&#x503C;</span></span><br><span class="line"> handleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> action = {</span><br><span class="line">      type: <span class="string">&apos;CHANGE_INPUT_VAL&apos;</span>,</span><br><span class="line">      value: e.target.value</span><br><span class="line">    }</span><br><span class="line">    store.dispatch(action);</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure>
<p>&#x200B;                            </p>
<h4 id="reducer-&#x4E2D;&#x5B9A;&#x4E49;&#x5982;&#x4F55;&#x53BB;&#x6539;&#x53D8;-store-&#x4E2D;&#x7684;&#x503C;"><a href="#reducer-&#x4E2D;&#x5B9A;&#x4E49;&#x5982;&#x4F55;&#x53BB;&#x6539;&#x53D8;-store-&#x4E2D;&#x7684;&#x503C;" class="headerlink" title="reducer &#x4E2D;&#x5B9A;&#x4E49;&#x5982;&#x4F55;&#x53BB;&#x6539;&#x53D8; store &#x4E2D;&#x7684;&#x503C;"></a>reducer &#x4E2D;&#x5B9A;&#x4E49;&#x5982;&#x4F55;&#x53BB;&#x6539;&#x53D8; store &#x4E2D;&#x7684;&#x503C;</h4><p>store/index.js, &#x901A;&#x8FC7;&#x5F15;&#x5165; redux &#x4E2D;&#x7684; createStore &#x6765;&#x521B;&#x5EFA;&#x4E00;&#x4E2A; store</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { createStore } <span class="keyword">from</span> <span class="string">&apos;redux&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">&apos;./reducer&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = createStore(</span><br><span class="line">  reducer,</span><br><span class="line">  <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION__ &amp;&amp; <span class="built_in">window</span>.__REDUX_DEVTOOLS_EXTENSION__()</span><br><span class="line">);</span><br><span class="line"><span class="comment">// window &#x8FD9;&#x53E5;&#x662F;&#x4E3A;&#x4E86;&#x63A7;&#x5236;&#x53F0;&#x4E2D;&#x80FD;&#x6253;&#x5F00; redux</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></tbody></table></figure>
<p>store/reducer.js</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> initState = {</span><br><span class="line">  inpVal: <span class="string">&apos;&apos;</span>,</span><br><span class="line">  list: [<span class="string">&apos;&#x84DD;&#x5929;&apos;</span>, <span class="string">&apos;&#x767D;&#x4E91;&apos;</span>, <span class="string">&apos;&#x9633;&#x5149;&apos;</span>, <span class="string">&apos;&#x5927;&#x6D77;&apos;</span>]</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=initState, action) =&gt; {</span><br><span class="line">  <span class="keyword">const</span> newState = <span class="built_in">JSON</span>.parse( <span class="built_in">JSON</span>.stringify(state));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (action.type) {</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&apos;CHANGE_INPUT_VAL&apos;</span>:</span><br><span class="line">      newState.inpVal = action.value;</span><br><span class="line">      <span class="keyword">return</span> newState;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&apos;ADD_TODO_ITEM&apos;</span>:</span><br><span class="line">      newState.list.push(action.value);</span><br><span class="line">      newState.inpVal = <span class="string">&apos;&apos;</span>;</span><br><span class="line">      <span class="keyword">return</span> newState;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&apos;DELETE_TODO_ITEM&apos;</span>:</span><br><span class="line">      newState.list.splice(action.index, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">return</span> newState;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> state;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>&#x200B;                </p>
<h4 id="subscribe-&#x76D1;&#x63A7;-store-&#x4E2D;&#x503C;&#x7684;&#x53D8;&#x5316;"><a href="#subscribe-&#x76D1;&#x63A7;-store-&#x4E2D;&#x503C;&#x7684;&#x53D8;&#x5316;" class="headerlink" title="subscribe  &#x76D1;&#x63A7; store &#x4E2D;&#x503C;&#x7684;&#x53D8;&#x5316;"></a>subscribe  &#x76D1;&#x63A7; store &#x4E2D;&#x503C;&#x7684;&#x53D8;&#x5316;</h4><p>todoList.js:</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">componentDidMount () {</span><br><span class="line">   store.subscribe(<span class="keyword">this</span>.handleStoreChange);   <span class="comment">// &#x8BA2;&#x9605;&#x4E86; store &#x4E2D;&#x7684;&#x503C;</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">handleStoreChange = <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">   <span class="keyword">this</span>.setState(store.getState());</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>&#x200B;                </p>
<p>&#x901A;&#x8FC7; redux &#x7BA1;&#x7406;&#x72B6;&#x6001;&#x7684;&#x8FC7;&#x7A0B;&#x57FA;&#x672C;&#x5B9E;&#x73B0;&#x4E86;&#xFF0C;todoList.js &#x603B;&#x548C;&#x8D77;&#x6765;&#x5C31;&#x662F;&#x8FD9;&#x6837;&#x7684;&#xFF1A;</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, { Component } <span class="keyword">from</span> <span class="string">&apos;react&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&apos;../store&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">c</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>{</span><br><span class="line"></span><br><span class="line">  state = store.getState()</span><br><span class="line"></span><br><span class="line">  componentDidMount () {</span><br><span class="line">    store.subscribe(<span class="keyword">this</span>.handleStoreChange);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  render () {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;input value={ <span class="keyword">this</span>.state.inpVal } onChange={ <span class="keyword">this</span>.handleChange }&gt;<span class="xml"><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span></span><br><span class="line">          &lt;button onClick={ <span class="keyword">this</span>.handleAdd }&gt;&#x6DFB;&#x52A0;&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">        &lt;ul&gt;</span><br><span class="line">          {</span><br><span class="line">            <span class="keyword">this</span>.state.list.map( <span class="function">(<span class="params">item, index</span>) =&gt;</span> (</span><br><span class="line">              &lt;li key={item + index}&gt;</span><br><span class="line">                { item }</span><br><span class="line">                &lt;button onClick={ ()=&gt;{ <span class="keyword">this</span>.handleDelete(index) } }&gt;X&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">              &lt;/</span>li&gt;</span><br><span class="line">            ))</span><br><span class="line">          }</span><br><span class="line">        &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>&gt;</span><br><span class="line">    )</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  handleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> action = {</span><br><span class="line">      type: <span class="string">&apos;CHANGE_INPUT_VAL&apos;</span>,</span><br><span class="line">      value: e.target.value</span><br><span class="line">    }</span><br><span class="line">    store.dispatch(action);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  handleAdd = <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> action = {</span><br><span class="line">      type: <span class="string">&apos;ADD_TODO_ITEM&apos;</span>,</span><br><span class="line">      value: <span class="keyword">this</span>.state.inpVal</span><br><span class="line">    }</span><br><span class="line">    store.dispatch( action );</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  handleDelete = <span class="function">(<span class="params">index</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> action = {</span><br><span class="line">      type: <span class="string">&apos;DELETE_TODO_ITEM&apos;</span>,</span><br><span class="line">      index</span><br><span class="line">    }</span><br><span class="line">    store.dispatch(action);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  handleStoreChange = <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">this</span>.setState(store.getState());</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> c;</span><br></pre></td></tr></tbody></table></figure>
<pre><code>&#x4F46; action &#x8FD9;&#x6837;&#x653E;&#x5728;&#x7EC4;&#x4EF6;&#x4E2D;&#x82E5;&#x662F;&#x51FA;&#x9519;&#x4E86;&#x4E5F;&#x4E0D;&#x592A;&#x597D;&#x627E;&#xFF0C;&#x6240;&#x4EE5;&#x628A;&#x5B83;&#x6574;&#x5408;&#x8D77;&#x6765;&#x653E;&#x5728;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#x4E2D;, &#x6240;&#x4EE5;&#x4E0B;&#x9762;&#x51E0;&#x4E2A;&#x90FD;&#x662F;&#x6574;&#x7406;&#x4EE3;&#x7801;
</code></pre><p>&#x200B;                        </p>
<h4 id="action-&#x62BD;&#x79BB;&#x6210;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;"><a href="#action-&#x62BD;&#x79BB;&#x6210;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;" class="headerlink" title="action &#x62BD;&#x79BB;&#x6210;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;"></a>action &#x62BD;&#x79BB;&#x6210;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;</h4><p>&#x5728; store &#x4E2D;&#x6574;&#x5408; actionTypes&#xFF0C;&#x5E76;&#x628A;&#x9700;&#x8981;&#x7684; action &#x5BFC;&#x51FA;&#xFF0C;&#x5728;&#x8FD9;&#x6837;&#x5728;&#x5176;&#x4ED6;&#x7EC4;&#x4EF6;&#x4E2D;&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x5C31;&#x884C;&#x4E86;</p>
<p>store/actionTypes.js : </p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> CHANGE_INPUT_VAL = <span class="string">&apos;CHANGE_INPUT_VAL&apos;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> ADD_TODO_ITEM = <span class="string">&apos;ADD_TODO_ITEM&apos;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> DELETE_TODO_ITEM = <span class="string">&apos;DELETE_TODO_ITEM&apos;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> COUNT_ADD = <span class="string">&apos;COUNT_ADD&apos;</span>;</span><br></pre></td></tr></tbody></table></figure>
<p>store/actionCreators.js : </p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Types <span class="keyword">from</span> <span class="string">&apos;./actionTypes&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getTodoChangeInputValAction = <span class="function">(<span class="params">value</span>) =&gt;</span> {</span><br><span class="line">  <span class="keyword">return</span> {</span><br><span class="line">    type: Types.CHANGE_INPUT_VAL,</span><br><span class="line">    value</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getTodoAddItemAction = <span class="function">(<span class="params">value</span>) =&gt;</span> {</span><br><span class="line">  <span class="keyword">return</span> {</span><br><span class="line">    type: Types.ADD_TODO_ITEM,</span><br><span class="line">    value</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getTodoDeleteItemAction = <span class="function">(<span class="params">index</span>) =&gt;</span> {</span><br><span class="line">  <span class="keyword">return</span> {</span><br><span class="line">    type: Types.DELETE_TODO_ITEM,</span><br><span class="line">    index</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getCountAddAction = <span class="function">(<span class="params">n</span>) =&gt;</span> {</span><br><span class="line">  <span class="keyword">return</span> {</span><br><span class="line">    type: Types.COUNT_ADD,</span><br><span class="line">    n</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5728; todoList.js &#x4E2D;&#x76F4;&#x63A5;&#x4F7F;&#x7528; actionCreators&#xFF1A;</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, { Component } <span class="keyword">from</span> <span class="string">&apos;react&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&apos;../store&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Actions <span class="keyword">from</span> <span class="string">&apos;../store/actionCreators&apos;</span>;</span><br><span class="line"></span><br><span class="line">  handleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> action = Actions.getTodoChangeInputValAction(e.target.value);</span><br><span class="line">    store.dispatch(action);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  handleAdd = <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> action = Actions.getTodoAddItemAction( <span class="keyword">this</span>.state.inpVal );</span><br><span class="line">    store.dispatch( action );</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure>
<p>&#x200B;                        </p>
<h4 id="&#x62BD;&#x79BB;-reducer"><a href="#&#x62BD;&#x79BB;-reducer" class="headerlink" title="&#x62BD;&#x79BB; reducer"></a>&#x62BD;&#x79BB; reducer</h4><p>&#x73B0;&#x5728; &#x8FD9;&#x4E2A;&#x9875;&#x9762;&#x6709;&#x4E24;&#x4E2A;&#x5C0F;&#x529F;&#x80FD;&#xFF0C;&#x4E00;&#x4E2A;&#x662F; todolist&#xFF0C;&#x4E00;&#x4E2A;&#x662F;counter &#xFF0C;&#x4F46;&#x4ED6;&#x4EEC;&#x7684; reducer &#x90FD;&#x662F;&#x5199;&#x5728;&#x4E00;&#x8D77;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x6B21;&#x628A;&#x5B83;&#x4EEC;&#x4E24;&#x4E2A;&#x62BD;&#x79BB;&#x51FA;&#x6765;&#xFF0C;&#x76EE;&#x5F55;&#x7ED3;&#x6784;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;</p>
<p><img src="/posts/39058069/four.png" alt=""></p>
<p>&#x5176;&#x4E2D;&#xFF0C;store/reducer/counter.js : </p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Types <span class="keyword">from</span> <span class="string">&apos;../actionTypes&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = {</span><br><span class="line">  count: <span class="number">0</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=initState, action) =&gt; {</span><br><span class="line">  <span class="keyword">const</span> newState = <span class="built_in">JSON</span>.parse( <span class="built_in">JSON</span>.stringify(state));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (action.type) {</span><br><span class="line">    <span class="keyword">case</span> Types.COUNT_ADD:</span><br><span class="line">      newState.count = newState.count + action.n;</span><br><span class="line">      <span class="keyword">return</span> newState;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> state;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>store/reducer/todoList.js : </p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Types <span class="keyword">from</span> <span class="string">&apos;../actionTypes&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = {</span><br><span class="line">  inpVal: <span class="string">&apos;&apos;</span>,</span><br><span class="line">  list: [<span class="string">&apos;&#x84DD;&#x5929;&apos;</span>, <span class="string">&apos;&#x767D;&#x4E91;&apos;</span>, <span class="string">&apos;&#x9633;&#x5149;&apos;</span>, <span class="string">&apos;&#x5927;&#x6D77;&apos;</span>]</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (state=initState, action) =&gt; {</span><br><span class="line">  <span class="keyword">const</span> newState = <span class="built_in">JSON</span>.parse( <span class="built_in">JSON</span>.stringify(state));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (action.type) {</span><br><span class="line">    <span class="keyword">case</span> Types.CHANGE_INPUT_VAL:</span><br><span class="line">      newState.inpVal = action.value;</span><br><span class="line">      <span class="keyword">return</span> newState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> Types.ADD_TODO_ITEM:</span><br><span class="line">      newState.list.push(action.value);</span><br><span class="line">      newState.inpVal = <span class="string">&apos;&apos;</span>;</span><br><span class="line">      <span class="keyword">return</span> newState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> Types.DELETE_TODO_ITEM:</span><br><span class="line">      newState.list.splice(action.index, <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">return</span> newState;</span><br><span class="line"></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> state;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>store/reducer/index.js , &#x6211;&#x4EEC;&#x7528; redux &#x4E2D;&#x7684; combineReducers &#xFF0C;&#x628A;&#x4E24;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#x7684; actionCreators&#x6574;&#x5408;&#x5728;&#x4E00;&#x8D77;&#xFF1A;</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> { combineReducers } <span class="keyword">from</span> <span class="string">&apos;redux&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> todoList <span class="keyword">from</span> <span class="string">&apos;./todoList&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> counter <span class="keyword">from</span> <span class="string">&apos;./counter&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineReducers({</span><br><span class="line">  todoList,</span><br><span class="line">  counter</span><br><span class="line">})</span><br></pre></td></tr></tbody></table></figure>
<p>reducer&#x6574;&#x5408;&#x540E;&#x4F7F;&#x7528;&#x7684;&#x51FD;&#x6570;&#x540D;&#x6709;&#x6CA1;&#x6709;&#x53D8;&#x5316;&#xFF0C;&#x5728; component/counter.js &#xFF1A;</p>
<figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, { Component } <span class="keyword">from</span> <span class="string">&apos;react&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&apos;../store&apos;</span>;</span><br><span class="line"><span class="keyword">import</span> { getCountAddAction } <span class="keyword">from</span> <span class="string">&apos;../store/actions/counter&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">c</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>{</span><br><span class="line"></span><br><span class="line">  state = store.getState().counter</span><br><span class="line"></span><br><span class="line">  componentDidMount () {</span><br><span class="line">    store.subscribe(<span class="function"><span class="params">()</span>=&gt;</span>{</span><br><span class="line">      <span class="keyword">this</span>.setState(store.getState().counter)</span><br><span class="line">    })</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  render () {</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        { <span class="keyword">this</span>.state.count }</span><br><span class="line">        &lt;button onClick={ <span class="keyword">this</span>.handleClick }&gt;add&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    )</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  handleClick = <span class="function"><span class="params">()</span> =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> action = getCountAddAction(<span class="number">3</span>);</span><br><span class="line">    store.dispatch(action);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> c;</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
  </div>
</article>

    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#安装redux："><span class="post-toc-number">1.</span> <span class="post-toc-text">安装redux：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#这次依然用-Todolist-举例"><span class="post-toc-number">2.</span> <span class="post-toc-text">这次依然用 Todolist 举例</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#新建-store-文件夹"><span class="post-toc-number">3.</span> <span class="post-toc-text">新建 store 文件夹</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#getState-获取-store-中的值"><span class="post-toc-number">4.</span> <span class="post-toc-text">getState 获取 store 中的值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#通过-dispatch-改变-store-中的值"><span class="post-toc-number">5.</span> <span class="post-toc-text">通过 dispatch 改变 store 中的值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#reducer-中定义如何去改变-store-中的值"><span class="post-toc-number">6.</span> <span class="post-toc-text">reducer 中定义如何去改变 store 中的值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#subscribe-监控-store-中值的变化"><span class="post-toc-number">7.</span> <span class="post-toc-text">subscribe  监控 store 中值的变化</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#action-抽离成一个组件"><span class="post-toc-number">8.</span> <span class="post-toc-text">action 抽离成一个组件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#抽离-reducer"><span class="post-toc-number">9.</span> <span class="post-toc-text">抽离 reducer</span></a></li></ol>
        </nav>
    </aside>
   
    </div>
    <footer class="footer-nav">
      
  <span class="footer-msg">
    2018
    
    
    <span class="timeDivide">-</span>
    
    Orange~.&nbsp;
    Power by
    <a href="https://hexo.io/" target="_blank" rel="external nofollow">Hexo</a>
    and
    <a class="orangelink" href="https://github.com/" target="_blank" rel="">
      orange</a>
  </span>

    </footer>
    <div class="back-top" id="back-top">
      <i class="back-top-icon"></i>
    </div>
    
  
  <script src="/js/jquery/jquery-3.1.1.min.js"></script>

    <script src="/js/theme.js"></script>
    <script src="/js/index.js"></script>
  
  </div>
</body>